@use "sass:color";
@use "../theme";
@use "../variable";

/// Generates a module shadow with configurable parameters
/// @param {Boolean} $enabled - Whether shadow is enabled
/// @param {Length} $offset - Shadow offset
/// @param {Length} $blur - Shadow blur radius
/// @param {Length} $spread - Shadow spread
/// @param {Number} $opacity - Shadow opacity (0-100)
@mixin module-shadow($enabled, $offset, $blur, $spread, $opacity) {
  @if $enabled {
    $shadow: 0 0 0 variable.$bar-border-width theme.$shadow-color,
      $offset $blur $spread color.adjust(theme.$shadow-color, $alpha: calc($opacity * 0.01 - 1));
    box-shadow: $shadow;
  } @else {
    box-shadow: none;
  }
}

/* General */

/// Resets common CSS properties to their default/unset values
%unset {
  outline: none;
  border: 0;
  box-shadow: none;
}

/// Adds a red debug border for troubleshooting layout issues
%debug {
  border: 1px solid red;
}

/// Styles for clear/close icons with slight scaling and highlight effect
%clear_icon {
  -gtk-icon-transform: scale(1.05);
  -gtk-icon-effect: highlight;
}

/// Base label styling with theme colors and font weight
%label {
  @extend %unset;
  color: theme.$text-main;
  font-weight: variable.$font-weight;
}

/// Hover state styling for widgets with background transition
%widget_hover {
  background-color: theme.$background;
  transition: border-color 400ms ease-in-out;
}

/// Base styling for desktop widgets with smooth color transitions
%desktop-widget {
  transition: color .5s ease;
  color: theme.$text-main;
  font-family: "Jost*", sans-serif;
}

/* General Typography */

/// Large title typography for major headings
%large_title {
  font-weight: 600;
  font-size: 32px;
}

/// Primary title typography (largest)
%title_1 {
  font-weight: 800;
  font-size: 27px;
}

/// Secondary title typography
%title_2 {
  font-weight: 800;
  font-size: 20px;
}

/// Tertiary title typography
%title_3 {
  font-weight: 700;
  font-size: 20px;
}

/// Quaternary title typography
%title_4 {
  font-weight: 700;
  font-size: 18px;
}

/// Quinary title typography
%title_5 {
  font-weight: 700;
  font-size: 16px;
}

/// General heading typography
%heading {
  font-weight: 700;
  font-size: 14.6px;
}

/// Caption heading typography for smaller section headers
%caption_heading {
  font-weight: 700;
  font-size: 13px;
}

/// Standard caption typography
%caption {
  font-weight: 400;
  font-size: 12px;
}

/// Smaller text typography for fine details
%smaller {
  font-weight: 400;
  font-size: 12px;
}



/// Mixin for styling slider/progress bar widgets with customizable appearance
/// @param {Length} $height - Height of the slider trough
/// @param {Color} $highlight-color - Color for the filled portion
/// @param {Boolean} $knob - Whether to show a draggable knob
/// @param {Length} $radius - Border radius for rounded corners
/// @param {Color} $slider-color - Background color of the slider trough
/// @param {Length} $min-length - Minimum width of the slider
@mixin slider(
  $height: 11px,
  $highlight-color: white,
  $knob: false,
  $radius: variable.$radius,
  $slider-color: theme.$background-dark,
  $min-length: "",

) {
  trough {
    transition: 200ms;
    border-radius: $radius;
    border: variable.$border;
    background-color: $slider-color;
    min-height: $height;
    min-width: $height;

    highlight,
    progress {
      border-radius: max($radius - variable.$border-width, 0);
      background-color: $highlight-color;
      min-height: $height;

      &:hover {
        background-color: color.mix($highlight-color,
            black, 80%);
      }
    }
  }

  @if $min-length !="" {
    scale {
      min-width: $min-length;
    }
  }

  @if $knob {
    slider {
      background-color: theme.$text-main;
      border-color: variable.$border-color;
      box-shadow: 0 0 3px 0 theme.$shadow-color;
      border: variable.$border-width solid transparent;
      transition: 200ms;
      border-radius: variable.$radius-large;
      min-height: $height;
      min-width: $height;
      margin: -0.5em;

      &:hover {
        background-color: color.mix(theme.$text-main,
            black, 90%);
      }
    }
  }

  &:disabled {

    highlight,
    progress {
      background-color: color.mix(theme.$text-main, transparent, 60%);
      background-image: none;
    }
  }
}

/// Mixin for floating/popover widget styling with shadow, border, and background
/// @param {Length} $radius - Border radius for the widget corners
@mixin floating-widget($radius: variable.$bar-menus-popover-border-radius) {
  @include module-shadow(
    variable.$bar-menus-popover-shadow-enabled,
    variable.$bar-menus-popover-shadow-offset,
    variable.$bar-menus-popover-shadow-blur,
    variable.$bar-menus-popover-shadow-spread,
    variable.$bar-menus-popover-shadow-opacity
  );
  margin: max(variable.$spacing, 8px);
  border: if(variable.$bar-menus-popover-border-enabled, variable.$bar-menus-popover-border-width solid variable.$popover-border-color, none);
  background-color: theme.$background-dark;
  color: theme.$text-main;
  border-radius: $radius;
  padding: variable.$bar-menus-popover-padding_x variable.$bar-menus-popover-padding_y;
}

/// Mixin for bar widget border and icon styling
/// @param {String} $widget-name - The widget name prefix (e.g., 'cpu', 'memory')
/// @param {Length} $border-radius - Border radius value
/// @param {Boolean} $border-enabled - Whether border is enabled
/// @param {Length} $border-width - Border width value
/// @param {Length} $icon-size - Icon font size (optional)
/// @param {Length} $spacing - Icon margin-right spacing (optional)
@mixin bar-widget-style($border-radius, $border-enabled, $border-width, $icon-size: null, $spacing: null) {
  border-radius: $border-radius;
  border: if($border-enabled, variable.$border, none);
  border-width: $border-width;

  @if $icon-size and $spacing {
    #nerd-icon.panel-font-icon {
      font-size: $icon-size;
      margin-right: $spacing;
    }
  }
}

/// Mixin for styling toggle switch widgets
@mixin switch {
  slider {
    background-color: theme.$background-dark;
    border-radius: variable.$radius-large;
    min-width: 24px;
    min-height: 24px;
  }

  image {
    color: transparent;
  }
}

/// Mixin for adding consistent spacing between child elements in horizontal/vertical containers
/// @param {Number} $multiplier - Multiplier for the base spacing value
/// @param {Length} $spacing - Base spacing value to use
/// @param {Boolean} $rec - Whether to apply spacing recursively to nested boxes
@mixin spacing($multiplier: 1, $spacing: variable.$spacing, $rec: false) {
  &.horizontal>* {
    margin: 0 calc($spacing * $multiplier / 2);

    &:first-child {
      margin-left: 0;
    }

    &:last-child {
      margin-right: 0;
    }
  }

  &.vertical>* {
    margin: calc($spacing * $multiplier / 2) 0;

    &:first-child {
      margin-top: 0;
    }

    &:last-child {
      margin-bottom: 0;
    }
  }

  @if $rec {
    box {
      &.horizontal>* {
        margin: 0 $spacing * $multiplier / 2;

        &:first-child {
          margin-left: 0;
        }

        &:last-child {
          margin-right: 0;
        }
      }

      &.vertical>* {
        margin: $spacing * $multiplier / 2 0;

        &:first-child {
          margin-top: 0;
        }

        &:last-child {
          margin-bottom: 0;
        }
      }
    }
  }
}


/// Mixin for applying predefined widget style classes based on type
/// @param {String} $type - The style type ('flat', 'shadow', 'bordered', 'leaf', 'leaf-inverse', or 'default')
@mixin widget_style($type) {
  @if $type ==flat {
    @extend .flat;
  }


  @else if $type ==shadow {
    @extend .shadow;
  }

  @else if $type ==bordered {
    @extend .bordered;
  }

  @else if $type ==leaf {
    @extend .leaf;
  }

  @else if $type ==leaf-inverse {
    @extend .leaf-inverse;
  }

  @else {
    @extend .default;
  }
}

/// Mixin to set image and label background/color consistently
@mixin image-label-colors($bg: theme.$background, $color: theme.$text-main) {
  image,
  label {
    background-color: $bg;
    color: $color;
  }
}

/// Mixin for nerd icon sizing used in multiple files
@mixin nerd-icon($size: null, $spacing: null) {
  #nerd-icon.panel-font-icon {
    @if $size {
      font-size: $size;
    }
    @if $spacing {
      margin-right: $spacing;
    }
  }
}
